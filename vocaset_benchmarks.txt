# REGULAR RUN

--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
                                        Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg       CPU Mem  Self CPU Mem    # of Calls  Source Location                                                              
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
                                aten::linear         0.17%      20.475ms        36.66%        4.507s      13.065ms       3.35 Gb           0 b           345  <built-in function linear>                                                   
                                                                                                                                                              torch/nn/modules/linear.py(113): forward                                     
                                                                                                                                                              nn.Module: Linear_77                                                         
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(133): test_model                                                     
                                                                                                                                                                                                                                           
                                 aten::addmm        28.64%        3.520s        36.38%        4.473s      12.964ms       3.35 Gb       3.35 Gb           345  <built-in function linear>                                                   
                                                                                                                                                              torch/nn/modules/linear.py(113): forward                                     
                                                                                                                                                              nn.Module: Linear_77                                                         
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(133): test_model                                                     
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      16.000us         9.23%        1.134s        1.134s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      20.000us         9.23%        1.134s        1.134s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      83.000us         9.23%        1.134s        1.134s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution         9.22%        1.134s         9.22%        1.134s        1.134s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                                 aten::copy_         7.73%     950.038ms         7.73%     950.038ms       2.754ms           0 b           0 b           345  <built-in function linear>                                                   
                                                                                                                                                              torch/nn/modules/linear.py(113): forward                                     
                                                                                                                                                              nn.Module: Linear_77                                                         
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(133): test_model                                                     
                                                                                                                                                                                                                                           
          aten::_native_multi_head_attention         0.43%      53.407ms         6.47%     794.980ms       2.304ms      14.57 Mb    -575.95 Mb           345  ...in method _native_multi_head_attention of type object at 0x7941ebca4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
          aten::scaled_dot_product_attention         0.03%       3.174ms         4.79%     588.592ms       1.706ms      14.57 Mb    -314.33 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
    aten::_scaled_dot_product_attention_math         0.15%      18.096ms         4.76%     585.418ms       1.697ms     328.90 Mb    -357.70 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      18.000us         4.65%     571.992ms     571.992ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      21.000us         4.65%     571.974ms     571.974ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      41.000us         4.65%     571.953ms     571.953ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution         4.65%     571.806ms         4.65%     571.874ms     571.874ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                                aten::select         3.31%     406.552ms         3.57%     438.299ms       3.672us           0 b           0 b        119370  faceformer.py(36): enc_dec_mask                                              
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(133): test_model                                                     
                                                                                                                                                              torch/utils/_contextlib.py(115): decorate_context                            
                                                                                                                                                              demo.py(316): main                                                           
                                                                                                                                                                                                                                           
                       aten::_masked_softmax         3.06%     375.962ms         3.10%     380.802ms       1.104ms     209.77 Mb           0 b           345  ...in method _native_multi_head_attention of type object at 0x7941ebca4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      15.000us         2.22%     272.622ms     272.622ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      20.000us         2.22%     272.607ms     272.607ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      50.000us         2.22%     272.587ms     272.587ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution         2.22%     272.454ms         2.22%     272.496ms     272.496ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7941ebca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
Self CPU time total: 12.294s


Last layer improvements
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
                                        Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg       CPU Mem  Self CPU Mem    # of Calls  Source Location                                                              
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
          aten::_native_multi_head_attention         0.84%      80.969ms        12.86%        1.244s       3.607ms      14.57 Mb    -574.58 Mb           345  ...in method _native_multi_head_attention of type object at 0x786b9dca4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      15.000us        11.35%        1.098s        1.098s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      19.000us        11.35%        1.098s        1.098s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      89.000us        11.35%        1.098s        1.098s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution        11.35%        1.098s        11.35%        1.098s        1.098s      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                                aten::select         8.40%     812.344ms         9.57%     925.797ms       7.756us           0 b           0 b        119370  faceformer.py(36): enc_dec_mask                                              
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(133): test_model                                                     
                                                                                                                                                              torch/utils/_contextlib.py(115): decorate_context                            
                                                                                                                                                              demo.py(316): main                                                           
                                                                                                                                                                                                                                           
          aten::scaled_dot_product_attention         0.05%       4.571ms         9.46%     914.988ms       2.652ms      14.59 Mb    -314.18 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
    aten::_scaled_dot_product_attention_math         0.27%      25.706ms         9.41%     910.417ms       2.639ms     328.77 Mb    -357.83 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                       aten::_masked_softmax         6.20%     600.045ms         6.28%     607.666ms       1.761ms     209.77 Mb     -62.02 Kb           345  ...in method _native_multi_head_attention of type object at 0x786b9dca4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      18.000us         5.87%     568.095ms     568.095ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      20.000us         5.87%     568.077ms     568.077ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      45.000us         5.87%     568.057ms     568.057ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution         5.87%     567.909ms         5.87%     567.974ms     567.974ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                               aten::softmax         0.05%       4.907ms         4.02%     389.423ms       1.129ms     314.20 Mb           0 b           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                              aten::_softmax         3.97%     384.516ms         3.97%     384.516ms       1.115ms     314.20 Mb     314.20 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                                aten::matmul         0.33%      32.275ms         3.87%     374.909ms     543.346us     328.77 Mb           0 b           690  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                                   aten::bmm         3.04%     293.748ms         3.04%     294.042ms     426.148us     328.77 Mb     328.77 Mb           690  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      17.000us         2.86%     276.275ms     276.275ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      22.000us         2.86%     276.258ms     276.258ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      45.000us         2.85%     276.236ms     276.236ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x786b9dca4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
Self CPU time total: 9.676s

Dynamic quantization
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
                                        Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg       CPU Mem  Self CPU Mem    # of Calls  Source Location                                                              
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
                                aten::conv1d         0.00%      16.000us        16.77%     860.298ms     860.298ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      17.000us        16.77%     860.282ms     860.282ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      47.000us        16.77%     860.265ms     860.265ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution        16.77%     860.110ms        16.77%     860.183ms     860.183ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
          aten::_native_multi_head_attention         0.69%      35.342ms        12.07%     619.137ms       1.795ms      14.57 Mb    -576.43 Mb           345  ...in method _native_multi_head_attention of type object at 0x7bccd54a4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
          aten::scaled_dot_product_attention         0.05%       2.628ms         8.34%     427.717ms       1.240ms      21.62 Mb    -307.13 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
    aten::_scaled_dot_product_attention_math         0.24%      12.096ms         8.29%     425.089ms       1.232ms     328.75 Mb    -357.39 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      16.000us         7.85%     402.798ms     402.798ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      16.000us         7.85%     402.782ms     402.782ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      42.000us         7.85%     402.766ms     402.766ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution         7.85%     402.625ms         7.85%     402.685ms     402.685ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                       aten::_masked_softmax         6.01%     308.111ms         6.07%     311.454ms     902.765us     209.77 Mb      -1.28 Mb           345  ...in method _native_multi_head_attention of type object at 0x7bccd54a4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
                                aten::select         5.47%     280.649ms         5.56%     285.447ms       2.391us           0 b           0 b        119370  faceformer.py(36): enc_dec_mask                                              
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(133): test_model                                                     
                                                                                                                                                              torch/utils/_contextlib.py(115): decorate_context                            
                                                                                                                                                              demo.py(316): main                                                           
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      16.000us         4.10%     210.331ms     210.331ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      17.000us         4.10%     210.315ms     210.315ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      43.000us         4.10%     210.298ms     210.298ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                    aten::mkldnn_convolution         4.10%     210.150ms         4.10%     210.216ms     210.216ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_3                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      13.000us         3.62%     185.705ms     185.705ms       1.01 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_7                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(396): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      22.000us         3.62%     185.692ms     185.692ms       1.01 Mb           0 b             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_7                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(396): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      67.000us         3.62%     185.670ms     185.670ms       1.01 Mb      -1.01 Mb             1  <built-in method conv1d of type object at 0x7bccd54a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_7                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(396): forward              
                                                                                                                                                                                                                                           
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
Self CPU time total: 5.130s



Statically quantization last linear layer
??

Statically quantization decoder layer
---------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  --------------------------------------------------------------------------  
                             Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg       CPU Mem  Self CPU Mem    # of Calls  Source Location                                                             
---------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  --------------------------------------------------------------------------  
                     aten::conv1d         0.00%      17.000us        12.28%     614.654ms     614.654ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_1                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
                aten::convolution         0.00%      18.000us        12.28%     614.637ms     614.637ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_1                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
               aten::_convolution         0.00%      54.000us        12.28%     614.619ms     614.619ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_1                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
         aten::mkldnn_convolution        12.28%     614.438ms        12.28%     614.520ms     614.520ms      35.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_1                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
                     aten::select         5.76%     288.276ms         5.87%     293.571ms       2.459us           0 b           0 b        119370  faceformer.py(36): enc_dec_mask                                             
                                                                                                                                                   faceformer.py(209): predict                                                 
                                                                                                                                                   demo.py(133): test_model                                                    
                                                                                                                                                   torch/utils/_contextlib.py(115): decorate_context                           
                                                                                                                                                   demo.py(316): main                                                          
                                                                                                                                                                                                                               
                     aten::conv1d         0.00%      22.000us         5.47%     273.890ms     273.890ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_2                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
                aten::convolution         0.00%      19.000us         5.47%     273.868ms     273.868ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_2                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
               aten::_convolution         0.00%      44.000us         5.47%     273.849ms     273.849ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_2                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
         aten::mkldnn_convolution         5.47%     273.688ms         5.47%     273.753ms     273.753ms      17.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_2                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
                    aten::softmax         0.04%       1.798ms         4.69%     234.827ms     680.658us     314.20 Mb           0 b           345  <built-in method softmax of Tensor object at 0x785fb6bd7880>                
                                                                                                                                                   torch/nn/functional.py(1813): softmax                                       
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(296): _forward_impl           
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(237): forward                 
                                                                                                                                                   nn.Module: MultiheadAttention_1                                             
                                                                                                                                                                                                                               
                   aten::_softmax         4.66%     233.029ms         4.66%     233.029ms     675.446us     314.20 Mb     314.20 Mb           345  <built-in method softmax of Tensor object at 0x785fb6bd7880>                
                                                                                                                                                   torch/nn/functional.py(1813): softmax                                       
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(296): _forward_impl           
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(237): forward                 
                                                                                                                                                   nn.Module: MultiheadAttention_1                                             
                                                                                                                                                                                                                               
                        aten::bmm         3.34%     167.011ms         3.34%     167.013ms     242.048us     328.77 Mb     328.77 Mb           690  <built-in method bmm of type object at 0x7860ac4a4880>                      
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(296): _forward_impl           
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(237): forward                 
                                                                                                                                                   nn.Module: MultiheadAttention_1                                             
                                                                                                                                                   torch/nn/modules/transformer.py(733): _mha_block                            
                                                                                                                                                                                                                               
                     aten::linear         0.04%       2.205ms         3.08%     154.144ms     446.794us      19.83 Mb           0 b           345  <built-in function linear>                                                  
                                                                                                                                                   torch/nn/modules/linear.py(113): forward                                    
                                                                                                                                                   nn.Module: Linear_77                                                        
                                                                                                                                                   faceformer.py(209): predict                                                 
                                                                                                                                                   demo.py(133): test_model                                                    
                                                                                                                                                                                                                               
                      aten::addmm         2.86%     143.204ms         2.98%     149.377ms     432.977us      19.83 Mb      19.83 Mb           345  <built-in function linear>                                                  
                                                                                                                                                   torch/nn/modules/linear.py(113): forward                                    
                                                                                                                                                   nn.Module: Linear_77                                                        
                                                                                                                                                   faceformer.py(209): predict                                                 
                                                                                                                                                   demo.py(133): test_model                                                    
                                                                                                                                                                                                                               
                    aten::softmax         0.04%       1.774ms         2.89%     144.724ms     419.490us     209.77 Mb       5.64 Kb           345  <built-in method softmax of Tensor object at 0x785fb6bd7880>                
                                                                                                                                                   torch/nn/functional.py(1813): softmax                                       
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(296): _forward_impl           
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(237): forward                 
                                                                                                                                                   nn.Module: MultiheadAttention_0                                             
                                                                                                                                                                                                                               
                   aten::_softmax         2.86%     142.968ms         2.86%     142.968ms     414.400us     209.77 Mb     209.77 Mb           345  <built-in method softmax of Tensor object at 0x785fb6bd7880>                
                                                                                                                                                   torch/nn/functional.py(1813): softmax                                       
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(296): _forward_impl           
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(237): forward                 
                                                                                                                                                   nn.Module: MultiheadAttention_0                                             
                                                                                                                                                                                                                               
                     aten::linear         0.05%       2.382ms         2.53%     126.450ms     366.522us      86.25 Kb           0 b           345  <built-in function linear>                                                  
                                                                                                                                                   torch/nn/modules/linear.py(113): forward                                    
                                                                                                                                                   nn.Module: Linear_78                                                        
                                                                                                                                                   faceformer.py(209): predict                                                 
                                                                                                                                                   demo.py(133): test_model                                                    
                                                                                                                                                                                                                               
               aten::masked_fill_         2.45%     122.463ms         2.45%     122.463ms     354.965us           0 b           0 b           345  <built-in method masked_fill_ of Tensor object at 0x78600d774810>           
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(296): _forward_impl           
                                                                                                                                                   torch/ao/nn/quantizable/modules/activation.py(237): forward                 
                                                                                                                                                   nn.Module: MultiheadAttention_1                                             
                                                                                                                                                   torch/nn/modules/transformer.py(733): _mha_block                            
                                                                                                                                                                                                                               
                     aten::conv1d         0.00%      13.000us         2.41%     120.447ms     120.447ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_3                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
                aten::convolution         0.00%      15.000us         2.41%     120.434ms     120.434ms       8.99 Mb           0 b             1  <built-in method conv1d of type object at 0x7860ac4a4880>                   
                                                                                                                                                   torch/nn/modules/conv.py(304): _conv_forward                                
                                                                                                                                                   torch/nn/modules/conv.py(312): forward                                      
                                                                                                                                                   nn.Module: Conv1d_3                                                         
                                                                                                                                                   transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward             
                                                                                                                                                                                                                               
---------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  --------------------------------------------------------------------------  
Self CPU time total: 5.004s


Statically quantization conv layers
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
                                        Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg       CPU Mem  Self CPU Mem    # of Calls  Source Location                                                              
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
          aten::_native_multi_head_attention         0.61%      45.376ms        10.36%     771.566ms       2.236ms      14.57 Mb    -574.63 Mb           345  ...in method _native_multi_head_attention of type object at 0x7a6c1c6a4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
          aten::scaled_dot_product_attention         0.04%       3.140ms         8.27%     616.241ms       1.786ms      25.64 Mb    -303.34 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
    aten::_scaled_dot_product_attention_math         0.21%      15.780ms         8.23%     613.101ms       1.777ms     328.99 Mb    -357.78 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                           quantized::conv1d         6.54%     487.261ms         7.66%     570.512ms     570.512ms       9.00 Mb     -53.98 Mb             1  <built-in method conv1d of PyCapsule object at 0x7a6baf8c7c00>               
                                                                                                                                                              torch/_ops.py(497): __call__                                                 
                                                                                                                                                              torch/ao/nn/quantized/modules/conv.py(359): forward                          
                                                                                                                                                              nn.Module: Conv1d_1                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                                  aten::gelu         6.05%     450.568ms         6.05%     450.608ms     450.608ms       9.00 Mb           0 b             1  <built-in function gelu>                                                     
                                                                                                                                                              transformers/activations.py(77): forward                                     
                                                                                                                                                              nn.Module: GELUActivation_1                                                  
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                              nn.Module: Wav2Vec2NoLayerNormConvLayer_0                                    
                                                                                                                                                                                                                                           
                                aten::select         5.11%     380.974ms         5.55%     413.738ms       3.466us           0 b           0 b        119370  faceformer.py(36): enc_dec_mask                                              
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(145): test_model                                                     
                                                                                                                                                              torch/utils/_contextlib.py(115): decorate_context                            
                                                                                                                                                              demo.py(328): main                                                           
                                                                                                                                                                                                                                           
                       aten::_masked_softmax         5.23%     389.327ms         5.28%     393.388ms       1.140ms     209.77 Mb           0 b           345  ...in method _native_multi_head_attention of type object at 0x7a6c1c6a4880>  
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_0                                              
                                                                                                                                                              torch/nn/modules/transformer.py(723): _sa_block                              
                                                                                                                                                              faceformer.py(71): quantize_decoder_forward                                  
                                                                                                                                                                                                                                           
                               aten::softmax         0.04%       2.823ms         3.63%     270.502ms     784.064us     314.20 Mb           0 b           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                              aten::_softmax         3.59%     267.679ms         3.59%     267.679ms     775.881us     314.20 Mb     314.20 Mb           345  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                           quantized::conv1d         3.15%     234.833ms         3.59%     267.642ms     267.642ms       4.50 Mb     -26.99 Mb             1  <built-in method conv1d of PyCapsule object at 0x7a6baf8c7c00>               
                                                                                                                                                              torch/_ops.py(497): __call__                                                 
                                                                                                                                                              torch/ao/nn/quantized/modules/conv.py(359): forward                          
                                                                                                                                                              nn.Module: Conv1d_2                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                                                                                                           
                                aten::matmul         0.25%      18.491ms         3.27%     243.283ms     352.584us     328.77 Mb           0 b           690  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                                  aten::gelu         3.00%     223.168ms         3.00%     223.210ms     223.210ms       4.50 Mb           0 b             1  <built-in function gelu>                                                     
                                                                                                                                                              transformers/activations.py(77): forward                                     
                                                                                                                                                              nn.Module: GELUActivation_2                                                  
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(311): forward              
                                                                                                                                                              nn.Module: Wav2Vec2NoLayerNormConvLayer_1                                    
                                                                                                                                                                                                                                           
                                aten::linear         0.05%       3.377ms         2.90%     216.343ms     627.081us      19.83 Mb           0 b           345  <built-in function linear>                                                   
                                                                                                                                                              torch/nn/modules/linear.py(113): forward                                     
                                                                                                                                                              nn.Module: Linear_77                                                         
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(145): test_model                                                     
                                                                                                                                                                                                                                           
                                 aten::addmm         2.70%     200.863ms         2.81%     209.412ms     606.991us      19.83 Mb      19.83 Mb           345  <built-in function linear>                                                   
                                                                                                                                                              torch/nn/modules/linear.py(113): forward                                     
                                                                                                                                                              nn.Module: Linear_77                                                         
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(145): test_model                                                     
                                                                                                                                                                                                                                           
                                   aten::bmm         2.66%     198.403ms         2.66%     198.425ms     287.572us     328.77 Mb     328.77 Mb           690  <built-in function scaled_dot_product_attention>                             
                                                                                                                                                              torch/nn/functional.py(5017): multi_head_attention_forward                   
                                                                                                                                                              torch/nn/modules/activation.py(1021): forward                                
                                                                                                                                                              nn.Module: MultiheadAttention_1                                              
                                                                                                                                                              torch/nn/modules/transformer.py(733): _mha_block                             
                                                                                                                                                                                                                                           
                                aten::linear         0.04%       3.257ms         2.38%     177.568ms     514.690us      86.25 Kb           0 b           345  <built-in function linear>                                                   
                                                                                                                                                              torch/nn/modules/linear.py(113): forward                                     
                                                                                                                                                              nn.Module: Linear_78                                                         
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(145): test_model                                                     
                                                                                                                                                                                                                                           
                                 aten::addmm         2.17%     161.595ms         2.22%     165.350ms     479.275us      86.25 Kb      86.25 Kb           345  <built-in function linear>                                                   
                                                                                                                                                              torch/nn/modules/linear.py(113): forward                                     
                                                                                                                                                              nn.Module: Linear_78                                                         
                                                                                                                                                              faceformer.py(209): predict                                                  
                                                                                                                                                              demo.py(145): test_model                                                     
                                                                                                                                                                                                                                           
                                aten::conv1d         0.00%      22.000us         2.09%     155.741ms     155.741ms       1.01 Mb           0 b             1  <built-in method conv1d of type object at 0x7a6c1c6a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_0                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(396): forward              
                                                                                                                                                                                                                                           
                           aten::convolution         0.00%      30.000us         2.09%     155.719ms     155.719ms       1.01 Mb           0 b             1  <built-in method conv1d of type object at 0x7a6c1c6a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_0                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(396): forward              
                                                                                                                                                                                                                                           
                          aten::_convolution         0.00%      85.000us         2.09%     155.689ms     155.689ms       1.01 Mb      -1.01 Mb             1  <built-in method conv1d of type object at 0x7a6c1c6a4880>                    
                                                                                                                                                              torch/nn/modules/conv.py(304): _conv_forward                                 
                                                                                                                                                              torch/nn/modules/conv.py(312): forward                                       
                                                                                                                                                              nn.Module: Conv1d_0                                                          
                                                                                                                                                              transformers/models/wav2vec2/modeling_wav2vec2.py(396): forward              
                                                                                                                                                                                                                                           
--------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ---------------------------------------------------------------------------  
Self CPU time total: 7.448s
